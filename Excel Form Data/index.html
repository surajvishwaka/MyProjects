<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Excel Form Data</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        * {
            padding: 0;
            margin: 0;
            box-sizing: border-box;
            font-family: sans-serif;
        }

        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .btn {
            cursor: pointer;
        }
    </style>
</head>

<body>
    <div class="container d-flex align-items-center justify-content-center min-vh-100 min-vw-100 bg-dark">
        <form method="POST" class="w-25 bg-white p-3" id="form">
            <h3 class="text-dark text-center mb-3">Get in touch!</h3>
            <div id="res" class="text-success"></div>
            <div data-mdb-input-init class="form-outline mb-4">
                <label class="form-label" for="form1Example1">Name: </label>
                <input type="text" name="name" id="form1Example1" class="form-control border-dark shadow-none"
                    required />
            </div>

            <div data-mdb-input-init class="form-outline mb-4">
                <label class="form-label" for="form1Example1">Email: </label>
                <input type="email" name="email" id="form1Example1" class="form-control border-dark shadow-none"
                    required />
            </div>

            <div data-mdb-input-init class="form-outline mb-4">
                <label class="form-label" for="form1Example1">Phone: </label>
                <input type="number" name="phone" id="form1Example1" class="form-control border-dark shadow-none"
                    required />
            </div>
            <br>
            <!-- Submit button -->
            <button data-mdb-ripple-init type="submit" name="btn" class="btn btn-primary btn-block fw-bold"
                style="width: 100%;">Submit</button>
        </form>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        let url = 'https://script.google.com/macros/s/AKfycbzdIxmctHvkkSsLGH3M6amN9iIJon5rlP56KpCb-RTLrj5BLHCjYXGy_qlQBV9xgrKmgQ/exec';
        let form = document.querySelector('#form');

        form.addEventListener("submit", (e) => {
            e.target.btn.innerHTML = "Submitting...";
            let d = new FormData(form);
            fetch(url, {
                method: "POST",
                body: d
            }).then((res) => res.text())
                .then((finalRes) => {
                    e.target.btn.innerHTML = "Submited";
                    document.getElementById("res").innerHTML = finalRes;
                    form.reset();
                    setTimeout(() => {
                        document.getElementById("res").innerHTML = '';
                        e.target.btn.innerHTML = "Submit";
                    }, 4000);
                });
            e.preventDefault();
        });
    </script>
</body>

</html>